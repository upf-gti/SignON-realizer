import { Quaternion } from "three";

/**
 * function printer ( skeleton ){
let o = {};
let bones = skeleton.bones;
o.thumb = bones[53].quaternion.toArray().concat( bones[53 + 1].quaternion.toArray().concat(bones[53 + 2].quaternion.toArray()));

o.index = bones[49].quaternion.toArray().concat( bones[49 + 1].quaternion.toArray().concat(bones[49 + 2].quaternion.toArray()));

o.middle = bones[45].quaternion.toArray().concat( bones[45 + 1].quaternion.toArray().concat(bones[45 + 2].quaternion.toArray()));

o.ring = bones[41].quaternion.toArray().concat( bones[41 + 1].quaternion.toArray().concat(bones[41 + 2].quaternion.toArray()));

o.little = bones[37].quaternion.toArray().concat( bones[37 + 1].quaternion.toArray().concat(bones[37 + 2].quaternion.toArray()));

console.log( JSON.stringify(o) );
}
 */

/* // original values
let __handShapes = { 
    fist: {"thumb":[0.0018530196357396563,0.19497404418060907,-0.06188461029253442,0.9788523824733845,-8.782964391497716e-7,-0.0015137295032147202,0.000008179052049820408,0.9999988510360043,0.032507102796339574,-0.14527320983151787,-0.058025282395142576,0.9871535328589071],"index":[0.6914257500804468,0.0029915055646038374,-0.012084447713816542,0.7223402906504536,0.8643136660321842,-0.00003549311278807067,-0.054423089179614345,0.49999999404885415,0.704836700077393,-0.00001302500591861557,0.05661492033256331,0.7071067973160778],"middle":[0.7070439391912343,0.007934159463307094,-0.00942729785147149,0.7070622709531661,0.808281240457831,-0.00005645408785665182,0.04346030868257512,0.5871904608055888,0.7055809934082172,0.000028189213895494325,-0.04642693368599198,0.7071067795153778],"ring":[0.6645359346386619,0.01116643514113454,0.01906019960334495,0.7469297036864239,0.7457593908974692,-0.00007839569724392052,-0.03949214898680515,0.6650438404768387,0.5612766055035564,-0.00014964990515442238,0.005416913178169942,0.8276105379253704],"little":[0.7032566680684813,-0.007133065697973082,0.020508969968594873,0.710604359530383,0.8655660179095758,-0.00005591650832726687,-0.028203988053468413,0.49999999564066533,0.23530971513311572,0.00010015236859408493,-0.004287716060823301,0.9719109946124025]},
    finger2: {"thumb":[0.003001127508701684,0.12936737859587571,-0.10028943157069002,0.9865075305110085,0.04696792922844854,-0.19029995491231427,-0.06219093752392099,0.9786277236989889,0.04996426288995249,-0.2234852936398722,-0.08918633924742521,0.9693315949209684],"index":[0.017044012830522343,0.004140770416130356,-0.00029788806948555414,0.9998461447958247,0,-0.00007098622557614136,0,0.9999999880977085,-1.6846436997504396e-9,-0.00001842131224769003,2.097324696675961e-8,1.0000000228105785],"middle":[0.7070439391912343,0.007934159463307094,-0.00942729785147149,0.7070622709531661,0.808281240457831,-0.00005645408785665182,0.04346030868257512,0.5871904608055888,0.7055809934082172,0.000028189213895494325,-0.04642693368599198,0.7071067795153778],"ring":[0.6645359346386619,0.01116643514113454,0.01906019960334495,0.7469297036864239,0.7457593908974692,-0.00007839569724392052,-0.03949214898680515,0.6650438404768387,0.5612766055035564,-0.00014964990515442238,0.005416913178169942,0.8276105379253704],"little":[0.7032566680684813,-0.007133065697973082,0.020508969968594873,0.710604359530383,0.8655660179095758,-0.00005591650832726687,-0.028203988053468413,0.49999999564066533,0.23530971513311572,0.00010015236859408493,-0.004287716060823301,0.9719109946124025]},
    finger23: {"thumb":[0.0022794653435585337,0.1707316847128341,-0.07620548713610673,0.9823635899472285,0,-0.00151081675529555,0,0.999998855474714,-7.436615224070791e-10,0.0003585544184088963,3.908980796388423e-8,0.9999999597492736],"index":[0.017044012830522343,0.004140770416130356,-0.00029788806948555414,0.9998461447958247,0,-0.00007098622557614136,0,0.9999999880977085,-1.6846436997504396e-9,-0.00001842131224769003,2.097324696675961e-8,1.0000000228105785],"middle":[5.616086699732009e-10,0.011220632582858586,4.2120328667204135e-8,0.9999370526128706,0,-0.00009614271933234615,0,0.999999996655778,5.730287296486453e-7,0.00004859203807294517,0.000008707545286023847,0.9999999972121575],"ring":[0.6645359346386619,0.01116643514113454,0.01906019960334495,0.7469297036864239,0.7457593908974692,-0.00007839569724392052,-0.03949214898680515,0.6650438404768387,0.5612766055035564,-0.00014964990515442238,0.005416913178169942,0.8276105379253704],"little":[0.7032566680684813,-0.007133065697973082,0.020508969968594873,0.710604359530383,0.8655660179095758,-0.00005591650832726687,-0.028203988053468413,0.49999999564066533,0.23530971513311572,0.00010015236859408493,-0.004287716060823301,0.9719109946124025]},
    finger23spread: {"thumb":[0.0022794653435585337,0.1707316847128341,-0.07620548713610673,0.9823635899472285,0,-0.00151081675529555,0,0.999998855474714,-7.436615224070791e-10,0.0003585544184088963,3.908980796388423e-8,0.9999999597492736],"index":[0.021510152312677222,0.09246830539497602,-0.0007900002351789001,0.9954829722792233,0.0005100662592279314,0.0009136261239025365,0.00001129511424901395,0.9999994431131443,0.002799090154767011,0.04001068407487087,0.002462177021585644,0.9991923207766276],"middle":[5.616086699732009e-10,0.011220632582858586,4.2120328667204135e-8,0.9999370526128706,0,-0.00009614271933234615,0,0.999999996655778,5.730287296486453e-7,0.00004859203807294517,0.000008707545286023847,0.9999999972121575],"ring":[0.6645359346386619,0.01116643514113454,0.01906019960334495,0.7469297036864239,0.7457593908974692,-0.00007839569724392052,-0.03949214898680515,0.6650438404768387,0.5612766055035564,-0.00014964990515442238,0.005416913178169942,0.8276105379253704],"little":[0.7032566680684813,-0.007133065697973082,0.020508969968594873,0.710604359530383,0.8655660179095758,-0.00005591650832726687,-0.028203988053468413,0.49999999564066533,0.23530971513311572,0.00010015236859408493,-0.004287716060823301,0.9719109946124025]},
    finger2345: {"thumb":[0.0022794653435585337,0.1707316847128341,-0.07620548713610673,0.9823635899472285,0,-0.00151081675529555,0,0.999998855474714,-7.436615224070791e-10,0.0003585544184088963,3.908980796388423e-8,0.9999999597492736],"index":[0.021510152312677222,0.09246830539497602,-0.0007900002351789001,0.9954829722792233,0.0005100662592279314,0.0009136261239025365,0.00001129511424901395,0.9999994431131443,0.002799090154767011,0.04001068407487087,0.002462177021585644,0.9991923207766276],"middle":[5.616086699732009e-10,0.011220632582858586,4.2120328667204135e-8,0.9999370526128706,0,-0.00009614271933234615,0,0.999999996655778,5.730287296486453e-7,0.00004859203807294517,0.000008707545286023847,0.9999999972121575],"ring":[-0.019516946804299665,-0.10146755584480316,0.011348681542380536,0.9945826272781053,4.6153803065908496e-7,-0.00010808115908647325,0.000008714273977344638,1.00000000154387,-4.5038419968587645e-10,-0.00018078813432669048,4.666713643909431e-8,0.9999999815149189],"little":[0.02546121957626908,-0.24791540338463394,0.007667565191065675,0.9684166886976683,6.859082930511572e-10,-0.00011175934429581744,2.1050161104864973e-8,0.9999999912895651,0.007985804376780365,0.00010305406975517036,-0.00014546837555952136,0.9999681160773469]},
    flat: {"thumb":[0.0022794653435585337,0.1707316847128341,-0.07620548713610673,0.9823635899472285,0,-0.00151081675529555,0,0.999998855474714,-7.436615224070791e-10,0.0003585544184088963,3.908980796388423e-8,0.9999999597492736],"index":[0.016890095975568824,0.0041407809790425885,-0.0002951769005223298,0.9998487574702477,0,-0.00007098622557614136,0,0.9999999880977085,0,-0.000018420140020094233,0,1.0000000228106003],"middle":[3.971172989112082e-10,0.011220632177106083,2.9783570026386184e-8,0.9999370526174242,-1.1304248783823738e-9,-0.00009614361978300669,2.102380886469946e-8,0.9999999966556912,0,0.00004863964629124621,0,0.9999999972479179],"ring":[0,0.014948163484529719,0,0.9998882555397323,4.6153937639029224e-7,-0.000108081158965594,0.000008714299386020977,1.0000000015438697,-8.340843003081576e-8,-0.00018198782346829333,0.000008642471443566478,0.9999999812599611],"little":[0.052243378675025536,-0.010023778072445009,0.0015235943135728952,0.9985829096073755,0,-0.00011175863053470422,0,0.999999991289645,1.5894243669828286e-7,0.00010326535170949689,0.000008722666762614637,1.0000000136420846]},
};
let __handShapes_2 = {
    pinch12: {"thumb":[0.00121578230989384,0.2305274286154774,-0.04064491951935322,0.9722158301001731,0.020716654308623184,-0.0847840575180043,-0.027433091597345426,0.9958061572557475,0.06553013788121059,-0.29322630450855025,-0.11697149554540107,0.9465948725105277],"index":[0.18330388031842149,0.004071167341770387,-0.0032036360923138286,0.9830426725864215,0.7139304345108338,-0.000049614301938028456,-0.04495392428634002,0.6987721074451329,0.2349152076201162,-0.000017924911609925605,0.01886927994216342,0.9718327228193454],"middle":[0.7070439391912343,0.007934159463307094,-0.00942729785147149,0.7070622709531661,0.808281240457831,-0.00005645408785665182,0.04346030868257512,0.5871904608055888,0.7055809934082172,0.000028189213895494325,-0.04642693368599198,0.7071067795153778],"ring":[0.6645359346386619,0.01116643514113454,0.01906019960334495,0.7469297036864239,0.7457593908974692,-0.00007839569724392052,-0.03949214898680515,0.6650438404768387,0.5612766055035564,-0.00014964990515442238,0.005416913178169942,0.8276105379253704],"little":[0.7032566680684813,-0.007133065697973082,0.020508969968594873,0.710604359530383,0.8655660179095758,-0.00005591650832726687,-0.028203988053468413,0.49999999564066533,0.23530971513311572,0.00010015236859408493,-0.004287716060823301,0.9719109946124025]},
    pinch12open: {"thumb": [0.08540163847796924,0.15087238847791873,-0.1567046758770474,0.9723105112819197,0.1899689973733643,-0.06635416420146091,-0.08638815429017378,0.9757284382687775,-0.007574740442949885,0.016971228679692828,-0.028796186050069724,0.9994125416629085],"index":[0.18155836828652763,0.004072509427722855,-0.0031731302589696306,0.9833666412736581,0.42770524274209776,-0.0000641581749827352,-0.026931202487294584,0.903516968729255,0.43244258924890006,-0.000016635845776128023,0.03473535538206261,0.9009921796408339],"middle":[0.7070439391912343,0.007934159463307094,-0.00942729785147149,0.7070622709531661,0.808281240457831,-0.00005645408785665182,0.04346030868257512,0.5871904608055888,0.7055809934082172,0.000028189213895494325,-0.04642693368599198,0.7071067795153778],"ring":[0.6645359346386619,0.01116643514113454,0.01906019960334495,0.7469297036864239,0.7457593908974692,-0.00007839569724392052,-0.03949214898680515,0.6650438404768387,0.5612766055035564,-0.00014964990515442238,0.005416913178169942,0.8276105379253704],"little":[0.7032566680684813,-0.007133065697973082,0.020508969968594873,0.710604359530383,0.8655660179095758,-0.00005591650832726687,-0.028203988053468413,0.49999999564066533,0.23530971513311572,0.00010015236859408493,-0.004287716060823301,0.9719109946124025]},
    pinchall: {"thumb":[0.21932482855438523,0.34326165372861406,-0.1339571579440134,0.9033955610614,0.17492832799172683,-0.5694418768987891,-0.234185137451195,0.7683055016170155,0.010890612150820402,0.04191102822411558,-0.21014845521067727,0.9767100568298479],"index":[0.5718095063919761,0.03433137996243063,-0.09992066377108859,0.8135546398703445,0.4725601952388525,0.00643219610422569,-0.038010859224002255,0.8804547941516412,0.49844732998386365,-0.00001596806408543083,0.04003703766981153,0.8659950003043363],"middle":[0.5515656353068519,0.009359076812331158,-0.007354197450290551,0.8340465725565378,0.32167689672561434,-0.003279263814240875,0.023872403937531046,0.9465428312691596,0.684408468643488,0.000029375419578852554,-0.04503342476960514,0.7277066955177283],"ring":[0.6664529630365379,-0.09334348357518975,0.1125914246543595,0.7310612726618874,0.015329110219104049,0.001798525110352605,-0.010013996010978242,0.9998307448846722,0.7070738512707975,-0.00012785250771476655,0.006823980229830957,0.7071067681127309],"little":[0.6842662997857555,-0.14649808811110795,0.21752671322505468,0.6804410816761417,0.289508540105359,0.009024302610585967,-0.019611913410652753,0.9569319385881688,0.3226406196806521,1.028587568179147e-8,-0.00006647252849091242,0.9465215603130762]},
    ceeall: {"thumb": [0.08540163847796924,0.15087238847791873,-0.1567046758770474,0.9723105112819197,0.1899689973733643,-0.06635416420146091,-0.08638815429017378,0.9757284382687775,-0.007574740442949885,0.016971228679692828,-0.028796186050069724,0.9994125416629085], "index":[0.39385312135097866,0.003806514950708226,-0.0068835576056811565,0.9191397566388322,0.21597167344557536,-0.00006931915522026257,-0.013598995171586522,0.9763049114025583,0.29096015406630676,-0.00001763246288543193,0.02337096510013339,0.9564497019632545],"middle":[0.45473647795109423,0.009993114649605212,-0.006063114025794135,0.8905493381684252,0.08544525860936904,-0.00009690765223646681,0.004602955903029673,0.9963322306048412,0.36672707559801393,0.00004198423172433106,-0.024125568735288736,0.930015700972571],"ring":[0.41033175922515613,0.013627883014813469,0.011777372955493986,0.9117584070464279,0.1103410308563135,-0.00010746664318896035,-0.005843984411926383,0.9938766060493166,0.4172433906150483,-0.00016429981060168898,0.004026825528950692,0.9087858418703385],"little":[0.34174174562637516,-0.009435390493419304,0.009974442128214817,0.9396935982800444,0.3009833226051288,-0.00010658557822682053,-0.009807339161254272,0.9535789633380914,0.37417065961854634,0.00009249671251663292,-0.006809882442268491,0.9273348761100895]},
    cee12: {"thumb":[0.00121578230989384,0.2305274286154774,-0.04064491951935322,0.9722158301001731,0.020716654308623184,-0.0847840575180043,-0.027433091597345426,0.9958061572557475,0.06553013788121059,-0.29322630450855025,-0.11697149554540107,0.9465948725105277],"index":[0.18330388031842149,0.004071167341770387,-0.0032036360923138286,0.9830426725864215,0.7139304345108338,-0.000049614301938028456,-0.04495392428634002,0.6987721074451329,0.2349152076201162,-0.000017924911609925605,0.01886927994216342,0.9718327228193454],"middle":[0.2543723527749108,0.010851456874967589,-0.0033915688881607604,0.9670395343891582,0.2369817955286433,-0.00009582734727501235,0.012750618888102751,0.9714304111350892,0.25101631838994837,0.0000448342136820655,-0.016510504480082445,0.9678420356624905],"ring":[0.08835340543503861,0.014889773079845249,0.00254287140594521,0.9959746359062185,0.1218804185475688,-0.0001073142701009314,-0.006455207685527788,0.9925238018291964,0.3052058125290549,-0.00017215505791456405,0.0029455391117639315,0.9522818395174016],"little":[0.0036646815426186127,-0.010037207451301577,0.00011559993649400192,0.9999429016970007,0.02249898733706474,-0.00011173253252486598,-0.0007330781415174321,0.9997465882664307,0.4804685378349156,0.0000863680816311329,-0.008747235310621751,0.876968357804183]},
    cee12open: {"thumb": [0.08540163847796924,0.15087238847791873,-0.1567046758770474,0.9723105112819197,0.1899689973733643,-0.06635416420146091,-0.08638815429017378,0.9757284382687775,-0.007574740442949885,0.016971228679692828,-0.028796186050069724,0.9994125416629085],"index":[0.18155836828652763,0.004072509427722855,-0.0031731302589696306,0.9833666412736581,0.42770524274209776,-0.0000641581749827352,-0.026931202487294584,0.903516968729255,0.43244258924890006,-0.000016635845776128023,0.03473535538206261,0.9009921796408339],"middle":[0.2543723527749108,0.010851456874967589,-0.0033915688881607604,0.9670395343891582,0.2369817955286433,-0.00009582734727501235,0.012750618888102751,0.9714304111350892,0.25101631838994837,0.0000448342136820655,-0.016510504480082445,0.9678420356624905],"ring":[0.08835340543503861,0.014889773079845249,0.00254287140594521,0.9959746359062185,0.1218804185475688,-0.0001073142701009314,-0.006455207685527788,0.9925238018291964,0.3052058125290549,-0.00017215505791456405,0.0029455391117639315,0.9522818395174016],"little":[0.0036646815426186127,-0.010037207451301577,0.00011559993649400192,0.9999429016970007,0.02249898733706474,-0.00011173253252486598,-0.0007330781415174321,0.9997465882664307,0.4804685378349156,0.0000863680816311329,-0.008747235310621751,0.876968357804183]}

};
let __thumbShapes = { 
    "default":[0.0022794653435585337,0.1707316847128341,-0.07620548713610673,0.9823635899472285,0,-0.00151081675529555,0,0.999998855474714,-7.436615224070791e-10,0.0003585544184088963,3.908980796388423e-8,0.9999999597492736],
    "out": [-0.03260129206312933,0.46379609613743733,0.11905160346325731,0.8773010064550864,0.0853436778039208,0.062333569166805665,0.03190692969141125,0.9938877824832648,-0.010016398742713432,-0.06880106012823001,-0.028040484661204755,0.9971859732072269],
    "opposed": [0.08540163847796924,0.15087238847791873,-0.1567046758770474,0.9723105112819197,0.1899689973733643,-0.06635416420146091,-0.08638815429017378,0.9757284382687775,-0.007574740442949885,0.016971228679692828,-0.028796186050069724,0.9994125416629085],
    "across": [0.002338244526771588,0.1674610615307345,-0.07811557120964285,0.98277631548024,0.08589917914010663,-0.34672870761858576,-0.11374644073541787,0.9270718823663198,0.08401164692677214,-0.37603385726544764,-0.14996105414442384,0.9105230978236823],

    "touch": [-0.1778899014435918,0.2050290632816525,-0.16838697939349118,0.9476096741780158,-1.4997517824308141e-9,-0.0015108217290137331,1.3966295823978405e-8,0.9999988554671995,0.015666964407101254,-0.06982826272609713,-0.02796557034727364,0.9970438981739445]
};*/


let handShapes = {
    fist: {"thumb":[0.00185,0.19497,-0.06188,0.97885,0,-0.00151,0.00001,1,0.03251,-0.14527,-0.05803,0.98715], "index":[0.69143,0.00299,-0.01208,0.72234,0.86431,-0.00004,-0.05442,0.5,0.70484,-0.00001,0.05661,0.70711], "middle":[0.70704,0.00793,-0.00943,0.70706,0.80828,-0.00006,0.04346,0.58719,0.70558,0.00003,-0.04643,0.70711], "ring":[0.66454,0.01117,0.01906,0.74693,0.74576,-0.00008,-0.03949,0.66504,0.56128,-0.00015,0.00542,0.82761], "little":[0.70326,-0.00713,0.02051,0.7106,0.86557,-0.00006,-0.0282,0.5,0.23531,0.0001,-0.00429,0.97191] },
    finger2: {"thumb":[0.003,0.12937,-0.10029,0.98651,0.04697,-0.1903,-0.06219,0.97863,0.04996,-0.22349,-0.08919,0.96933],"index":[0.01704,0.00414,-0.0003,0.99985,0,-0.00007,0,1,0,-0.00002,0,1],"middle":[0.70704,0.00793,-0.00943,0.70706,0.80828,-0.00006,0.04346,0.58719,0.70558,0.00003,-0.04643,0.70711],"ring":[0.66454,0.01117,0.01906,0.74693,0.74576,-0.00008,-0.03949,0.66504,0.56128,-0.00015,0.00542,0.82761],"little":[0.70326,-0.00713,0.02051,0.7106,0.86557,-0.00006,-0.0282,0.5,0.23531,0.0001,-0.00429,0.97191]},
    finger23: {"thumb":[0.00228,0.17073,-0.07621,0.98236,0,-0.00151,0,1,0,0.00036,0,1],"index":[0.01704,0.00414,-0.0003,0.99985,0,-0.00007,0,1,0,-0.00002,0,1],"middle":[0,0.01122,0,0.99994,0,-0.0001,0,1,0,0.00005,0.00001,1],"ring":[0.66454,0.01117,0.01906,0.74693,0.74576,-0.00008,-0.03949,0.66504,0.56128,-0.00015,0.00542,0.82761],"little":[0.70326,-0.00713,0.02051,0.7106,0.86557,-0.00006,-0.0282,0.5,0.23531,0.0001,-0.00429,0.97191]},
    finger23spread: {"thumb":[0.00228,0.17073,-0.07621,0.98236,0,-0.00151,0,1,0,0.00036,0,1],"index":[0.02151,0.09247,-0.00079,0.99548,0.00051,0.00091,0.00001,1,0.0028,0.04001,0.00246,0.99919],"middle":[0,0.01122,0,0.99994,0,-0.0001,0,1,0,0.00005,0.00001,1],"ring":[0.66454,0.01117,0.01906,0.74693,0.74576,-0.00008,-0.03949,0.66504,0.56128,-0.00015,0.00542,0.82761],"little":[0.70326,-0.00713,0.02051,0.7106,0.86557,-0.00006,-0.0282,0.5,0.23531,0.0001,-0.00429,0.97191]},
    finger2345: {"thumb":[0.00228,0.17073,-0.07621,0.98236,0,-0.00151,0,1,0,0.00036,0,1],"index":[0.02151,0.09247,-0.00079,0.99548,0.00051,0.00091,0.00001,1,0.0028,0.04001,0.00246,0.99919],"middle":[0,0.01122,0,0.99994,0,-0.0001,0,1,0,0.00005,0.00001,1],"ring":[-0.01952,-0.10147,0.01135,0.99458,0,-0.00011,0.00001,1,0,-0.00018,0,1],"little":[0.02546,-0.24792,0.00767,0.96842,0,-0.00011,0,1,0.00799,0.0001,-0.00015,0.99997]},
    flat: {"thumb":[0.00228,0.17073,-0.07621,0.98236,0,-0.00151,0,1,0,0.00036,0,1],"index":[0.01689,0.00414,-0.0003,0.99985,0,-0.00007,0,1,0,-0.00002,0,1],"middle":[0,0.01122,0,0.99994,0,-0.0001,0,1,0,0.00005,0,1],"ring":[0,0.01495,0,0.99989,0,-0.00011,0.00001,1,0,-0.00018,0.00001,1],"little":[0.05224,-0.01002,0.00152,0.99858,0,-0.00011,0,1,0,0.0001,0.00001,1]}
};

let handShapes_2 = {
    pinch12: {"thumb":[0.00122,0.23053,-0.04064,0.97222,0.02072,-0.08478,-0.02743,0.99581,0.06553,-0.29323,-0.11697,0.94659],"index":[0.1833,0.00407,-0.0032,0.98304,0.71393,-0.00005,-0.04495,0.69877,0.23492,-0.00002,0.01887,0.97183],"middle":[0.70704,0.00793,-0.00943,0.70706,0.80828,-0.00006,0.04346,0.58719,0.70558,0.00003,-0.04643,0.70711],"ring":[0.66454,0.01117,0.01906,0.74693,0.74576,-0.00008,-0.03949,0.66504,0.56128,-0.00015,0.00542,0.82761],"little":[0.70326,-0.00713,0.02051,0.7106,0.86557,-0.00006,-0.0282,0.5,0.23531,0.0001,-0.00429,0.97191]},
    pinch12open: {"thumb":[0.0854,0.15087,-0.1567,0.97231,0.18997,-0.06635,-0.08639,0.97573,-0.00757,0.01697,-0.0288,0.99941],"index":[0.18156,0.00407,-0.00317,0.98337,0.42771,-0.00006,-0.02693,0.90352,0.43244,-0.00002,0.03474,0.90099],"middle":[0.70704,0.00793,-0.00943,0.70706,0.80828,-0.00006,0.04346,0.58719,0.70558,0.00003,-0.04643,0.70711],"ring":[0.66454,0.01117,0.01906,0.74693,0.74576,-0.00008,-0.03949,0.66504,0.56128,-0.00015,0.00542,0.82761],"little":[0.70326,-0.00713,0.02051,0.7106,0.86557,-0.00006,-0.0282,0.5,0.23531,0.0001,-0.00429,0.97191]},
    pinchall: {"thumb":[0.21932,0.34326,-0.13396,0.9034,0.17493,-0.56944,-0.23419,0.76831,0.01089,0.04191,-0.21015,0.97671],"index":[0.57181,0.03433,-0.09992,0.81355,0.47256,0.00643,-0.03801,0.88045,0.49845,-0.00002,0.04004,0.866],"middle":[0.55157,0.00936,-0.00735,0.83405,0.32168,-0.00328,0.02387,0.94654,0.68441,0.00003,-0.04503,0.72771],"ring":[0.66645,-0.09334,0.11259,0.73106,0.01533,0.0018,-0.01001,0.99983,0.70707,-0.00013,0.00682,0.70711],"little":[0.68427,-0.1465,0.21753,0.68044,0.28951,0.00902,-0.01961,0.95693,0.32264,0,-0.00007,0.94652]},
    ceeall: {"thumb":[0.0854,0.15087,-0.1567,0.97231,0.18997,-0.06635,-0.08639,0.97573,-0.00757,0.01697,-0.0288,0.99941],"index":[0.39385,0.00381,-0.00688,0.91914,0.21597,-0.00007,-0.0136,0.9763,0.29096,-0.00002,0.02337,0.95645],"middle":[0.45474,0.00999,-0.00606,0.89055,0.08545,-0.0001,0.0046,0.99633,0.36673,0.00004,-0.02413,0.93002],"ring":[0.41033,0.01363,0.01178,0.91176,0.11034,-0.00011,-0.00584,0.99388,0.41724,-0.00016,0.00403,0.90879],"little":[0.34174,-0.00944,0.00997,0.93969,0.30098,-0.00011,-0.00981,0.95358,0.37417,0.00009,-0.00681,0.92733]},
    cee12: {"thumb":[0.00122,0.23053,-0.04064,0.97222,0.02072,-0.08478,-0.02743,0.99581,0.06553,-0.29323,-0.11697,0.94659],"index":[0.1833,0.00407,-0.0032,0.98304,0.71393,-0.00005,-0.04495,0.69877,0.23492,-0.00002,0.01887,0.97183],"middle":[0.25437,0.01085,-0.00339,0.96704,0.23698,-0.0001,0.01275,0.97143,0.25102,0.00004,-0.01651,0.96784],"ring":[0.08835,0.01489,0.00254,0.99597,0.12188,-0.00011,-0.00646,0.99252,0.30521,-0.00017,0.00295,0.95228],"little":[0.00366,-0.01004,0.00012,0.99994,0.0225,-0.00011,-0.00073,0.99975,0.48047,0.00009,-0.00875,0.87697]},
    cee12open: {"thumb":[0.0854,0.15087,-0.1567,0.97231,0.18997,-0.06635,-0.08639,0.97573,-0.00757,0.01697,-0.0288,0.99941],"index":[0.18156,0.00407,-0.00317,0.98337,0.42771,-0.00006,-0.02693,0.90352,0.43244,-0.00002,0.03474,0.90099],"middle":[0.25437,0.01085,-0.00339,0.96704,0.23698,-0.0001,0.01275,0.97143,0.25102,0.00004,-0.01651,0.96784],"ring":[0.08835,0.01489,0.00254,0.99597,0.12188,-0.00011,-0.00646,0.99252,0.30521,-0.00017,0.00295,0.95228],"little":[0.00366,-0.01004,0.00012,0.99994,0.0225,-0.00011,-0.00073,0.99975,0.48047,0.00009,-0.00875,0.87697]}
};

let thumbShapes = {
    default: [0.00228,0.17073,-0.07621,0.98236,0,-0.00151,0,1,0,0.00036,0,1],
    out: [-0.0326,0.4638,0.11905,0.8773,0.08534,0.06233,0.03191,0.99389,-0.01002,-0.0688,-0.02804,0.99719],
    opposed: [0.0854,0.15087,-0.1567,0.97231,0.18997,-0.06635,-0.08639,0.97573,-0.00757,0.01697,-0.0288,0.99941],
    across: [0.00234,0.16746,-0.07812,0.98278,0.0859,-0.34673,-0.11375,0.92707,0.08401,-0.37603,-0.14996,0.91052],
    touch: [-0.17789,0.20503,-0.16839,0.94761,0,-0.00151,0,1,0.01567,-0.06983,-0.02797,0.99704]
};




class HandGesture { // hand keyframe
 /*   thumb:  [ thumbBone1.quat, thumbBone2.quat, thumbBone3.quat ]
    index:  [ index1.quat, index2.quat, index3.quat ]
    middle:  [ middle1.quat, middle2.quat, middle3.quat ]
    ring:  [ ring1.quat, ring2.quat, ring3.quat ]
    little: [ little1.quat, little2.quat, little3.quat ]*/

    constructor () {
        this.thumb = [ 0,0,0,1, 0,0,0,1, 0,0,0,1, ];
        this.index = [ 0,0,0,1, 0,0,0,1, 0,0,0,1, ];
        this.middle = [ 0,0,0,1, 0,0,0,1, 0,0,0,1, ];
        this.ring = [ 0,0,0,1, 0,0,0,1, 0,0,0,1, ];
        this.little = [ 0,0,0,1, 0,0,0,1, 0,0,0,1, ];
    }
};


// receives bml instructions and animates the hands
class HandGestureManager {
    constructor(character){
        this.skeleton = null;
        character.traverse( o => {
            if( o.isSkinnedMesh ){
                this.skeleton = o.skeleton;
            }
        })
        this.boneIdxs = { // base bone indexes.
            wrist: 0,
            thumb: 0,
            index: 0,
            middle: 0,
            ring: 0,
            little: 0
        }


        let bones = this.skeleton.bones;
        for( let i = 0; i < bones.length; ++i ){
            if ( bones[i].name.includes("RightHandThumb1") ){ this.boneIdxs.thumb = i; }
            if ( bones[i].name.includes("RightHandIndex1") ){ this.boneIdxs.index = i; }
            if ( bones[i].name.includes("RightHandMiddle1") ){ this.boneIdxs.middle = i; }
            if ( bones[i].name.includes("RightHandRing1") ){ this.boneIdxs.ring = i; }
            if ( bones[i].name.includes("RightHandPinky1") ){ this.boneIdxs.little = i; }
        }
        this.hgests = []; // 0 current (init) gesture 
        this.times  = []; // timestamps
        
        this.currentTime = 0;

        this.gest = new HandGesture();

        this.newGesture("flat", 0.001);
        this.times.push( 0 );

        if( !window.test ){ window.test = []; }
        window.test.push(this);
    }

    reset() {}

    update(dt) {
        this.currentTime += dt;
        if ( this.hgests.length < 2 ){ return; }


        let end = false;
        let t = (this.currentTime) /  this.times[1];
        if ( t > 1){ t = 1; end = true; }
        t = Math.sin(Math.PI * t - Math.PI * 0.5) * 0.5 + 0.5;

        let bones = this.skeleton.bones;
        bones[35].quaternion.set(0,0,0,1);

        let qa = new Quaternion();
        let qb = new Quaternion();
        
        qa.fromArray( this.hgests[0].thumb, 0 ).normalize(); qb.fromArray( this.hgests[1].thumb, 0 ).normalize();
        bones[ this.boneIdxs.thumb ].quaternion.slerpQuaternions(qa,qb,t);
        qa.fromArray( this.hgests[0].thumb, 4 ).normalize(); qb.fromArray( this.hgests[1].thumb, 4 ).normalize();
        bones[ this.boneIdxs.thumb +1 ].quaternion.slerpQuaternions(qa,qb,t);
        qa.fromArray( this.hgests[0].thumb, 8 ).normalize(); qb.fromArray( this.hgests[1].thumb, 8 ).normalize();
        bones[ this.boneIdxs.thumb +2 ].quaternion.slerpQuaternions(qa,qb,t);

        qa.fromArray( this.hgests[0].index, 0 ).normalize(); qb.fromArray( this.hgests[1].index, 0 ).normalize();
        bones[ this.boneIdxs.index ].quaternion.slerpQuaternions(qa,qb,t)
        qa.fromArray( this.hgests[0].index, 4 ).normalize(); qb.fromArray( this.hgests[1].index, 4 ).normalize();
        bones[ this.boneIdxs.index +1 ].quaternion.slerpQuaternions(qa,qb,t);
        qa.fromArray( this.hgests[0].index, 8 ).normalize(); qb.fromArray( this.hgests[1].index, 8 ).normalize();
        bones[ this.boneIdxs.index +2 ].quaternion.slerpQuaternions(qa,qb,t);

        qa.fromArray( this.hgests[0].middle, 0 ).normalize(); qb.fromArray( this.hgests[1].middle, 0 ).normalize();
        bones[ this.boneIdxs.middle ].quaternion.slerpQuaternions(qa,qb,t);
        qa.fromArray( this.hgests[0].middle, 4 ).normalize(); qb.fromArray( this.hgests[1].middle, 4 ).normalize();
        bones[ this.boneIdxs.middle +1 ].quaternion.slerpQuaternions(qa,qb,t);
        qa.fromArray( this.hgests[0].middle, 8 ).normalize(); qb.fromArray( this.hgests[1].middle, 8 ).normalize();
        bones[ this.boneIdxs.middle +2 ].quaternion.slerpQuaternions(qa,qb,t);

        qa.fromArray( this.hgests[0].ring, 0 ).normalize(); qb.fromArray( this.hgests[1].ring, 0 ).normalize();
        bones[ this.boneIdxs.ring ].quaternion.slerpQuaternions(qa,qb,t);
        qa.fromArray( this.hgests[0].ring, 4 ).normalize(); qb.fromArray( this.hgests[1].ring, 4 ).normalize();
        bones[ this.boneIdxs.ring +1 ].quaternion.slerpQuaternions(qa,qb,t);
        qa.fromArray( this.hgests[0].ring, 8 ).normalize(); qb.fromArray( this.hgests[1].ring, 8 ).normalize();
        bones[ this.boneIdxs.ring +2 ].quaternion.slerpQuaternions(qa,qb,t);

        qa.fromArray( this.hgests[0].little, 0 ).normalize(); qb.fromArray( this.hgests[1].little, 0 ).normalize();
        bones[ this.boneIdxs.little ].quaternion.slerpQuaternions(qa,qb,t);
        qa.fromArray( this.hgests[0].little, 4 ).normalize(); qb.fromArray( this.hgests[1].little, 4 ).normalize();
        bones[ this.boneIdxs.little +1 ].quaternion.slerpQuaternions(qa,qb,t);
        qa.fromArray( this.hgests[0].little, 8 ).normalize(); qb.fromArray( this.hgests[1].little, 8 ).normalize();
        bones[ this.boneIdxs.little +2 ].quaternion.slerpQuaternions(qa,qb,t);
        
        if ( end ){ this.hgests.splice(0, 1); this.times.splice(0,1); this.currentTime = 0;}
    }


    newGesture(shape, t = 3, thumb = null){

        let newG = new HandGesture();

        let g = handShapes_2[shape];
        if ( g ){
            newG.thumb = g.thumb;
            newG.index = g.index;
            newG.middle = g.middle;
            newG.ring = g.ring;
            newG.little = g.little;
        }else{
            g = handShapes[shape];
            if ( !g ){ g = handShapes.flat; }
            newG.thumb = g.thumb;
            newG.index = g.index;
            newG.middle = g.middle;
            newG.ring = g.ring;
            newG.little = g.little;

            if ( thumb ){
                let thumbGest = thumbShapes[thumb];
                if ( thumbGest ){ newG.thumb = thumbGest; }
            }

        }

        if ( this.hgests.length < 2 ){ this.currentTime = 0;}
        this.times.push( t );
        this.hgests.push( newG );
    }

}



export { HandGestureManager, HandGesture };